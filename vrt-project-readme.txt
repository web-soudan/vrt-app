# VRTテストアプリケーション

このプロジェクトは、Playwrightを使用してウェブサイトの視覚的回帰テスト(VRT)を行うためのアプリケーションです。2つのURLスクリーンショットを取得して、視覚的な差分を検出・比較することができます。

## 主な機能

- URLを指定してウェブサイトのスクリーンショット取得
- 2つのスクリーンショットの視覚的差分検出
- 差分表示、横並び表示、スライダー表示の切り替え
- 差分強調表示のカスタマイズ

## インストール方法

### 必要条件

- Node.js (バージョン14以上)
- npm または yarn

### セットアップ手順

1. リポジトリをクローンまたは解凍する

```bash
git clone https://github.com/yourusername/vrt-app.git
cd vrt-app
```

2. クライアントとサーバーの依存関係をインストール

```bash
# クライアント側の依存関係インストール
cd client
npm install

# サーバー側の依存関係インストール
cd ../server
npm install

# Playwrightのブラウザをインストール
npx playwright install chromium
```

3. アプリケーションの起動

```bash
# サーバー起動（server ディレクトリ内で）
npm start

# 別ターミナルでクライアント起動（client ディレクトリ内で）
cd ../client
npm start
```

4. ブラウザで http://localhost:3000 にアクセスしてアプリケーションを使用

## 使い方

1. テスト設定セクションで以下を設定：
   - テストするURL
   - スクリーンショット前の待機時間
   - 差分検出のしきい値

2. 「1回目スクリーンショット取得」ボタンをクリックして基準となるスクリーンショットを撮影

3. 必要に応じてURLを変更し、「2回目スクリーンショット取得」ボタンをクリックして比較用のスクリーンショットを撮影

4. 「比較結果」セクションで差分を確認：
   - 「差分表示」モード：変更部分がハイライト表示される
   - 「横並び比較」モード：2つのスクリーンショットが横に並ぶ
   - 「スライダー比較」モード：スライダーを動かして両方のスクリーンショットを比較

## プロジェクト構成

```
vrt-app/
├── client/                 # フロントエンド (React)
│   ├── public/
│   ├── src/
│   │   ├── App.js          # メインアプリケーションコンポーネント
│   │   ├── App.css         # スタイル
│   │   └── ...
│   ├── package.json
│   └── ...
├── server/                 # バックエンド (Node.js + Express + Playwright)
│   ├── screenshots/        # スクリーンショット保存ディレクトリ
│   ├── diffs/              # 差分画像保存ディレクトリ
│   ├── uploads/            # 静的ファイル提供用ディレクトリ
│   ├── index.js            # サーバーエントリーポイント
│   ├── screenshot.js       # Playwright スクリーンショット機能
│   ├── diff.js             # 差分検出機能
│   └── package.json
└── README.md
```

## 技術スタック

- フロントエンド: React, Tailwind CSS
- バックエンド: Node.js, Express
- スクリーンショット: Playwright
- 差分検出: pixelmatch

## 注意点

- このアプリケーションはローカル環境で動作します。本番環境で使用する場合は、セキュリティ対策を適切に行ってください。
- 大きなウェブサイトのスクリーンショットを取得する場合、メモリ使用量が増加する可能性があります。

## ライセンス

MIT